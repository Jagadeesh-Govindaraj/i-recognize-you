#labels Featured,Phase-Design,Phase-Implementation
=*Rozpoznawanie twarzy, Face recognition*=

==*Wstęp*==

Tradycyjne formy zabezpieczeń aplikacji i dostępu do usług, takie jak kody PIN, hasła i loginy, są podatne na przechwycenie przez osoby niepowołane, można je zapomnieć lub zgubić zapisane gdzieś na skrawku papieru. Natomiast coraz bardziej popularne stają się zabezpieczenia w postaci klucza zawartego w ciele człowieka. Twarz jest jednym z tych kluczy. Jest unikatowa i niepowtarzalna dla każdego człowieka. System rozpoznawania twarzy można wykorzystać, poza kontrolą dostępu, do przeszukiwania bazy zdjęć – jak np.: automatyczne odszukiwanie zdjęć, na których się znajdujemy, czy też do kontroli dostępu, np.: do pomieszczeń, w których wolno nam przebywać bądź też nie. Ponadto zabezpieczenia w postaci kluczy biologicznych są dużo tańsze niż rozwiązania wykorzystujące karty chipowe, urządzenia zbliżeniowe czy też jakieś klucze sprzętowe na pamięci przenośnej.
==*Cel badań*==
Celem moich badań było opracowanie sposobu weryfikacji tożsamości osoby z wykorzystaniem twarzy jako biologicznego klucza, który jest unikalny i łatwy w użyciu przez zwykłego użytkownika, ponieważ wystarczy tylko spojrzenie aby dokonać autoryzacji.
==*Materiał i metody*==
Zadanie, jakim jest rozpoznanie twarzy polega na podzieleniu danych wejściowych w postaci obrazów na wiele klas, które są odpowiednikami osób. Jak wiadomo, obrazy te mogą zawierać szumy, czyli piksele nie mające związku z twarzą. Ponadto piksele danego obrazu nie są w całości losowe. Pomiędzy tymi losowymi obszarami pojawiają się obszary tworzące pewne wzory, które mogą oznaczać obecność pewnych obiektów, takich jak: nos, oczy czy usta, oraz zawierają względne odległości pomiedzy nimi. Te charakterystyczne wzory/cechy nazywane są eigenfaces lub głównymi składowymi. Cechy charakterystyczne(eigenfaces) dla danej twarzy są odnajdowane z wykorzystaniem PCA(Principal Component Analysis). Każda cecha(eigenface) jest tylko reprezentacją pewnej cechy twarzy, która może być widoczna w obrazie lub nie. Jeśli cecha jest obecna w obrazie w większym stopniu to wtedy jej udział w odpowiadającej jej eigenface jest większy. W przeciwnym wypadku, gdy stopień cechy jest prawie mniejszy lub nieobecny to jej udział jest mniejszy w sumie eigenfaces lub żadny. Opisywany wyżej udział, określa w jakim stopniu określona cecha jest widoczna w obrazie.Wykorzystując wszystkie eigenfaces uzyskane z obrazów wejściowych można odtworzyć pierwotne obrazy z eigenfaces, bądź też dokonać tylko częściowej rekonstrukcji obrazu poprzez aproksymację. Dla rozpoznawania twarzy istotne są tylko wagi otrzymane w wyniku działania algorytmu PCA. Wagi oznaczają wielkość mowiącą o tym czy twarz różni się od typowych twarzy reprezentowanych poprzez eigenfaces. Używanie tych wag pozwala określić czy obraz zawiera twarz i czy istnieją podobne twarze do danej twarzy. Do wykonania tego zadania została wykorzystana biblioteka OpenCV, która posiada zestawy API do wykonywania zadań z dziedziny przetwarzania obrazu.<br><br>
Aby móc wykonywać operacje sprawdzania tożsamości osoby na podstawie cech charakterystycznych twarzy, wymagane jest jej wcześniejsze wprowadzenie do tzw. bazy twarzy. Baza twarzy w tym przypadku to odpowiednio obrobione i zapisane obrazy tylko samej twarzy danej osoby i pozostałych osób, które są w bazie. W nazwach plików zawarte są dane na temat osób, których twarze są zebrane w tej prostej bazie. Zarówno dla czynności wprowadzania twarzy do bazy jak i jej rozpoznawania można wyróżnić trzy wspólne etapy, wymienione i opisane poniżej:
  #  Akwizycja, czyli pozyskanie obrazu z kamery. Warunki oświetleniowe jak i samo ustawienie kamery mają wpływ na obraz, dlatego powinny być zbliżone podczas wprowadzania twarzy do bazy jak i porównywania jej z nią. 
  #  Kolejnym krokiem jest wykrycie twarzy w obrazie i jej zapisanie w pamięci oraz dostosowanie do rozmiaru pozostałych twarzy w bazie. W przypadku tej aplikacji rozmiar wynosi 100 pikseli szerokości jak i wysokości. Dla pewności, że twarz danej osoby jest skierowana prosto w kamerę, jest dokonywane sprawdzenie widoczności oczu. Stan powiek, zamknięta czy otwarta, nie ma znaczenia.
  #  Następnie obraz zawierający odnalezioną twarz poddawany jest operacjom morfologicznym, które mają na celu usunięcie szumów, niepotrzebnego tła twarzy, wyrównania jasności. Operacje morfologiczne sprawiają, że skuteczność algorytmu rozpoznawania twarzy wzrasta.
Po wykonaniu powyższych kroków obraz w przypadku dodawania do bazy jest zapisywany do pliku o odpowiedniej nazwie w formacie: imię nazwisko numer godzina minuta sekunda. Dla każdej twarzy zapisywanych jest dziesięć obrazów twarzy dla podniesienia skuteczności algorytmu rozpoznawania, ponieważ twarz zawsze może znajdować się minimalnie w innym położeniu. Wprowadzanie twarzy do bazy jest łatwe. Należy tylko podać swoje dane i popatrzeć w kamerę, a reszta zostanie wykonana automatycznie.
Rozpoznawanie twarzy wykorzystuje te same kroki co powyżej, jednakże są one wykonywane zarówno podczas odczytywania cech charakterystycznych przez algorytm, o twarzach zawartych w bazie twarzy, jak i przy sprawdzaniu twarzy poddawanej weryfikacji. Weryfikacja ma na celu stwierdzenie czy dana osoba znajduje się w bazie lub nie. 

==*Wyniki*==
Wykrywanie twarzy w obrazie pozyskanym z kamery przebiega bez żadnym problemów. Jedynie osoby o czarnym kolorze skóry bądź znajdujące się w mrocznym pomieszczeniu mogą zostać nie zauważone. Dodatkowo przed wykryciem twarzy jest sprawdzana widoczność oczu, ponieważ gdy nie jest to wykonane to otrzymujemy w efekcie inną twarz. Pozyskany obraz twarzy musi zostać poddany operacjom morfologicznym, takim jak: normalizacja histogramu czy usuwanie tła, na którym znajduje się twarz, aby późniejsze wyniki rozpoznawania danej osoby były prawdziwe. Metoda PCA wykorzystana do wydobywania istotnych cech twarzy jest niestety podatna na warunki otoczenia w jakim jest pobierany obraz twarzy do celów weryfikacji tożsamości, dlatego należy przed właściwym rozpoznaniem wykonać czynności przygotowujące obraz danej twarzy do porównania z bazą, bądź przed wprowadzeniem do bazy twarzy. Odpowiednio dobrane metody realizacji mają bezpośredni wpływ na szybkość i jakość rozpoznania twarzy. Im więcej zdjęć zawiera baza dla danej osoby, tym większą skutecznością system rozpoznawania twarzy wykazuje się, dlatego zbyt mała liczba ujęć twarzy wpłynęła by negatywnie na skuteczność rozpoznania, a właściwie jego brak.
==*Dyskusja*==
W czasie rozpoznawania twarzy można napotkać na następujące błędy rozpoznania polegające na:
  # błędnym rozpoznaniu – nastąpiło przypisanie weryfikowanej twarzy do twarzy kogoś kto jest w bazie,
  # fałszywym odrzuceniu twarzy – gdy twarz wystepuje w bazie, a nie zostanie rozpoznana,
  # fałszywej akceptacji – przypisaniu twarzy do twarzy kogoś innego, pomimo nie występowania tej twarzy w bazie.
Błędne rezultaty rozpoznawania twarzy z wykorzystaniem PCA są spowodowane w głównej mierze warunkami oświetleniowymi podczas wprowadzania użytkownika do bazy jak i podczas akwizycji obrazu zawierającego twarz do rozpoznania. Ponadto samo tło na jakim znajduje się dana twarz może być mylące dla algorytmu rozpoznawania danego człowieka. Mimo tych niedogodności analiza PCA pozwala na szybkie i pozytywne zweryfikowanie tożsamości, pod warunkiem że wcześniej zostaną wykonane czynności przygotowujące obraz twarzy do rozpoznania, tak aby był jak najmniej mylony przez algorytm z tłem.
==*Bibliografia*==
  # Introduction to Face Detection and Face Recognition - Shevrim Emami ze strony: http://www.shervinemami.info/faceRecognition.html
  # Learning OpenCV, Computer Vision with the OpenCV Library – Gary Bradski, Adrian Kaehler

==*Zdjęcia i filmiki*==
Działanie aplikacji<br>
<wiki:video url="http://www.youtube.com/watch?v=XsPVnQTKYR4"/>
<br><br>
Wygląd interfejsu<br>
http://www.kni.iit.pwste.edu.pl/images/maska.png